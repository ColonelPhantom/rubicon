#!/bin/bash

STORM_DIR=$1
echo "Storm directory set to $STORM_DIR"
echo "Expect storm at $STORM_DIR/bin/storm"
EXAMPLE_DIR=$2
echo "Example directory is $EXAMPLE_DIR"
TO=$3
echo "Timeout is $TO"

echo "Running small models to check everything is fine..."
timeout $3 $STORM_DIR/bin/storm --prism $EXAMPLE_DIR/factory/factory5-par.prism --prop 'P=? [ F<=2 "allStrike"]' -e dd -const "p1=0.9867248974622046,p2=0.5295846429570307,p3=0.1761356612779088,p4=0.7599839693300378,p5=0.12617043713423082,q1=0.8768988497928354,q2=0.5519194050168751,q3=0.5636988688074267,q4=0.3805166805152361,q5=0.4547157064919809"
echo "Running models from table..."
timeout $3 $STORM_DIR/bin/storm --prism $EXAMPLE_DIR/herman/herman-13-random-parametric.prism --prop 'P=? [ F<=15 "stable"]' -e dd -const "p1=0.9846267867607119,p2=0.5064796388264969,p3=0.2728784026573764,p4=0.606854034258831,p5=0.9609613766508236,p6=0.837943454461926,p7=0.5056194686929423,p8=0.37262222379835175,p9=0.12931065018803822,p10=0.7892635807006183,p11=0.17713424582525739,p12=0.39485940329401115,p13=0.1113028644336489"
timeout $3 $STORM_DIR/bin/storm --prism $EXAMPLE_DIR/herman/herman-17-random-parametric.prism --prop 'P=? [ F<=15 "stable"]' -e dd -const "p1=0.7690407428558446,p2=0.6916878600778176,p3=0.5350543924970664,p4=0.9266316652508111,p5=0.9174280952836255,p6=0.6772795739530915,p7=0.9764231611591022,p8=0.29475032272727186,p9=0.013089086777461012,p10=0.7234641372758223,p11=0.2011853849105225,p12=0.9776672951380956,p13=0.7955319513287531,p14=0.2742033663058717,p15=0.6272288167275841,p16=0.12749428096935755,p17=0.6952803258858958"
timeout $3 $STORM_DIR/bin/storm --prism $EXAMPLE_DIR/factory/factory12-par.prism --prop 'P=? [ F<=10 "allStrike"]' -e dd -const "p1=0.38472566147124165,p2=0.052128616328280586,p3=0.3267262000133133,p4=0.26231222092204054,p5=0.5170282424306094,p6=0.7913516131048209,p7=0.6169204270899297,p8=0.8699963151345217,p9=0.49157479161861783,p10=0.32712776938710564,p11=0.8998958899312103,p12=0.8122093493550323,q1=0.9837261312731618,q2=0.13190122285221106,q3=0.7160413582046314,q4=0.012733776259962193,q5=0.5877463778400908,q6=0.44226923778701066,q7=0.7795904901707904,q8=0.1640325088873592,q9=0.8341792158063074,q10=0.04633043737613052,q11=0.664355127010848,q12=0.16939761523771868"
timeout $3 $STORM_DIR/bin/storm --prism $EXAMPLE_DIR/factory/factory15-par.prism --prop 'P=? [ F<=10 "allStrike"]' -e dd -const "p1=0.1134752617879744,p2=0.005765160663513957,p3=0.5150539246035184,p4=0.5424265862169643,p5=0.8603276156042203,p6=0.6219882000085278,p7=0.8200445011806976,p8=0.8459499010202332,p9=0.9811219309208192,p10=0.8846896411954995,p11=0.9418562269064301,p12=0.06358159924557427,p13=0.46698972598915245,p14=0.7663367537050503,p15=0.8941908784739437,q1=0.880558258249903,q2=0.9887305336664142,q3=0.5322143959204114,q4=0.7195759179141794,q5=0.5446587946323709,q6=0.810917507294044,q7=0.2693860173218309,q8=0.1225052017658872,q9=0.6138367743860367,q10=0.8603548728987486,q11=0.6358622369373694,q12=0.1772266519998984,q13=0.023580812462120182,q14=0.6311609958486516,q15=0.570542031040491"